{% extends 'lab_base.html' %}

{% block body %}
<div class="page-header">
<h1>Design Lab </h1> 
</div>



<!-- Style Guide Modal -->
<div class="modal fade" id="styleGuide" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Style Guide</h4>
      </div>
      	<div class="modal-body">
      		<p>No content yet. But drunk yoga is fun...</p>
      		<img src="http://media.giphy.com/media/W7o9UzkwWpA0o/giphy.gif"/></div>
  	</div>
</div>
</div>

<!-- Size Guide Modal -->
<div class="modal fade" id="sizeGuide" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Sizing Help</h4>
      </div>
      	<div class="modal-body">
      		<p>Need more sizing info...</p>
      		<img src="http://38.media.tumblr.com/2d3ee38e0f15b78187de8e51d64b495c/tumblr_n96tacfsi51ru5h8co1_500.gif"/>
      	</div>
  	</div>
</div>
</div>


<!-- Main content starts here -->
<div class="doll-area">
	<!-- this is the base image -->
	<img class="doll" data-toggle="tooltip" data-placement="top" title="Click anywhere on the pants to adjust the length" id="design-img" src="{{session['current_design']['style_svg']}}" alt="blank model"></img> 
	<div class="toolTip-area"></div>
</div>

<!-- Form starts here -->
<form action='/step2' method="post" id="step1-form">
<div class="row">
	<div class="well col-md-4">
		<label for="field-style">Fit: </label>
		{% for style in styles %}
		<input type="radio" name="style" class="style-button" value="{{style.style_id}}"> {{style.style_name}}
		{% endfor %}
		<br>
		<!-- Button to launch style guide modal window -->
		<button type="button" data-toggle="modal" data-target="#styleGuide" id="style-guide" > Style Guide </button> 
		
		<br>
	</div>
</div>
<div class="row">

	<div class="well col-md-4">
		<label for="field-size">Sizing: </label>
		<select name="size"> 	
			{% for size in sizes %}
		<option value="{{size.size_code}}">{{size.size}}</option>
		{% endfor %}
		</select>
		<br>
		<!-- Button to launch sizing help window -->
		<button type="button" data-toggle="modal" data-target="#sizeGuide" id="size-guide"> idk what my size is! </button>
	</div>
</div>

	<!-- slider to define waist height -->
	<!-- FIXME got to make the values associate with the waist options-->
	<div class="row">

	<div class="col-md-4 well" id="slider">
		<label>Waist height:</label>
		<br>
		<input class="bar" name="waist" type="range" min="0" max="1" step="1" value="0">
	</div>
</div>

	
	<!-- Sumbit button and hidden fields -->
	<div>
		<input type="hidden" name = "cut-css" id="cut-css" value="cut1">
		<input type="hidden" name="style-svg" id="style-svg">
		<input type="submit" href="/step2" value ="Next step please!">
	</div>
</form>


<!-- Javascript and JQuery!!!! 
Might move this to another doc later. -->
<script src="https://code.jquery.com/jquery.js"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/latest/js/bootstrap.js"></script>
<script> 

// define variables
var index;
var style_data;
var svg_path;


//define functions
var change_svg = function (style_data, index) {
	svg_path = style_data.cuts[index].style_svg;
	$('#design-img').attr('src', '/static/svg/'+svg_path);
};

var change_radio = function(style_data, index){


};



$(document).ready(function(){
    console.log("ready!");
    ////////GET DATA FROM SERVER////////
	$.get('/cut.json', function(data){
				console.log(data.cuts);
				style_data = data.cuts;
				index = 0;
		});

	///////EVENT HANDLERS////////
	var styleButtons = $('.style-button'); 

	for(var i=0; i<styleButtons.length; i++){
		$(styleButtons[i]).on('click', function(evt) {
			alert("Style change! Woot woot!");
			index = i;
			change_svg(index, style_data);
			change_radio();



	// new code to get the correct svg from the db
			var styleId = $(this).val();
			
			$.post('/style.json', {style_id : styleId}, function(data) {
				console.log(data);
				var styleImg= $('#design-img');
				styleImg.attr('src', '/static/svg/'+ data.styleSvg);
				var currentSvg = styleImg.attr('src')
				$('#style-svg').attr('value', currentSvg);

			});
		});
	};


	$('#design-img').click( function(evt){


			change_svg();
			chnage_radio();
		});



	$('#design-img').click( function(evt){
		console.log(evt);


		
			for (var i=0; i<style_data.length; i++){
				var svg = data.cuts[i].style_svg;
				console.log(svg); //this logs BOTH the svgs, not just for the one at index i 
				$(this).attr('src', '/static/svg/'+svg);//FIXME
				// add code here to select the corresponding radio button

			};
	});
		

	// 	cutArray = ['cut1', 'cut2', 'cut3']; 
	// 	//array of classes with different clip dimensions according the cut
	// 	currentIndex = 1;

	// 	$('#selected').click( function (evt) {
	// 		for (var i=0; i<cutArray.length; i++) {

	// 			if($(this).hasClass(cutArray[i])) {
	// 				$(this).removeClass(cutArray[i]);
	// 			};
	// 		};

	// 		$(this).addClass(cutArray[currentIndex]);
	// 		$('#cut-css').attr('value', cutArray[currentIndex]);


	// 		if (currentIndex === 2) {
	// 			currentIndex=0;
	// 		} else {
	// 			currentIndex++ // FIXME replace this if statement with a % 3  
	// 		};
	// 	});
	// });

// Form validation 
	$('#step1-form').on('submit', function(evt){
		var styleSelected = $("input[name='style']:checked").length;
		console.log(styleSelected);
		if(styleSelected == 0) {
		   //Is not Valid
		   evt.preventDefault();
		   alert("Please select a style!");
		   console.log(evt);
		}
	});

	$(function () {
	  $('[data-toggle="tooltip"]').tooltip()
	});
});




</script>

{% endblock %}
